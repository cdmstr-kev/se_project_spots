!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},t=(e,t,r)=>{const o=e.querySelector(`#${t.id}-error`);t.classList.remove(r.inputErrorClass),o.textContent="",o.classList.remove(r.errorClass)},r=(e,t,r)=>{(e=>e.some(e=>!e.validity.valid))(e)?o(t,r):(t.classList.remove(r.inactiveButtonClass),t.disabled=!1)},o=(e,t)=>{e.classList.add(t.inactiveButtonClass),e.disabled=!0},n=(e,o,n)=>{o.forEach(r=>{t(e,r,n)});const a=e.querySelector(n.submitButtonSelector);r(o,a,n)};function a(e,t,r="Save",o="Saving..."){e.textContent=t?o:r}const s=document.getElementById("logo"),c=document.getElementById("profile-picture");s.src="d3610e9c6dce3cb370d8.svg";const i=new class{constructor({baseUrl:e,headers:t}){this._baseUrl=e,this._headers=t}getAppInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.statusText}`))}editUserInfo({name:e,about:t}){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.statusText}`))}editUserAvatar({avatar:e}){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.statusText}`))}editLikeStatus({cardId:e,isLiked:t}){return console.log(t),fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"PUT":"DELETE",headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.statusText}`))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.statusText}`))}addCard({name:e,link:t}){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.statusText}`))}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(e=>e.ok?e.json():Promise.reject(`Error: ${e.statusText}`))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"8882c22c-2148-4e06-953e-3bab8baa4120","Content-Type":"application/json"}}),l=document.querySelector(".profile__edit-btn"),d=document.querySelector("#edit-profile-modal"),u=document.querySelector(".profile__name"),m=document.querySelector(".profile__description"),_=document.querySelector(".modal__form"),h=d.querySelector("#profile-name"),f=d.querySelector("#description"),v=document.querySelector("#profile-picture-modal"),y=document.querySelector(".profile__avatar-btn"),p=v.querySelector(".modal__form"),S=v.querySelector("#profile-picture-input"),E=document.querySelector("#delete-card-modal"),b=E.querySelector(".modal__form"),q=document.querySelector(".profile__new-post-btn"),g=document.querySelector("#new-post-modal"),L=g.querySelector(".modal__button"),k=document.querySelectorAll(".modal__close-btn"),C=document.querySelectorAll(".modal"),x=g.querySelector(".modal__form"),$=g.querySelector("#caption"),U=g.querySelector("#image-link"),j=document.querySelector(".cards__list"),T=document.querySelector("#card-template").content.querySelector(".card"),A=document.querySelector("#preview-modal"),I=A.querySelector(".modal__image"),P=A.querySelector(".modal__caption");let D,B;function w(e){e.classList.add("modal_is-open"),document.addEventListener("keydown",O)}function N(e){e.classList.remove("modal_is-open"),document.removeEventListener("keydown",O)}function O(e){"Escape"===e.key&&C.forEach(e=>{e.classList.contains("modal_is-open")&&N(e)})}function J(e,t="prepend"){const r=function(e){const t=T.cloneNode(!0),r=t.querySelector(".card__description"),o=t.querySelector(".card__image"),n=t.querySelector(".card__icon"),a=t.querySelector(".card__delete-btn");return 1==e.isLiked&&n.classList.add("card__icon_active"),o.src=e.link,o.alt=e.name,r.textContent=e.name,n.addEventListener("click",t=>function(e,t){e.preventDefault();const r=e.target;i.editLikeStatus({cardId:t,isLiked:!r.classList.contains("card__icon_active")}).then(()=>{r.classList.toggle("card__icon_active")}).catch(e=>{console.error("Error editing like status:",e)})}(t,e._id)),a.addEventListener("click",()=>function(e,t){D=e,B=t._id,w(E)}(t,e)),o.addEventListener("click",()=>{!function(e){I.src=e.link,I.alt=e.name,P.textContent=e.name,w(A)}(e)}),t}(e);j[t](r)}var H;k.forEach(e=>{const t=e.closest(".modal");e.addEventListener("click",()=>N(t))}),C.forEach(e=>{e.addEventListener("click",t=>{t.target===e&&N(e)})}),l.addEventListener("click",function(){h.value=u.textContent,f.value=m.textContent,n(d,[h,f],e),w(d)}),y.addEventListener("click",function(){w(v)}),q.addEventListener("click",function(){w(g)}),p.addEventListener("submit",function(e){e.preventDefault();const t=e.submitter;a(t,!0),i.editUserAvatar({avatar:S.value}).then(e=>{c.src=e.avatar,N(v)}).catch(e=>{console.error("Error updating user info:",e)}).finally(()=>{a(t,!1)})}),_.addEventListener("submit",function(e){e.preventDefault();const t=e.submitter;a(t,!0),i.editUserInfo({name:h.value,about:f.value}).then(e=>{u.textContent=e.name,m.textContent=e.about,N(d)}).catch(e=>{console.error("Error updating user info:",e)}).finally(()=>{a(t,!1)})}),b.addEventListener("submit",function(e){e.preventDefault();const t=e.submitter;a(t,!0,"Delete","Deleting..."),i.deleteCard(B).then(()=>{D.remove(),N(E)}).catch(e=>{console.error("Error deleting card:",e)}).finally(()=>{a(t,!1,"Delete","Deleting...")})}),x.addEventListener("submit",function(t){t.preventDefault(),a(t.submitter,!0);const r={name:$.value,link:U.value};i.addCard(r).then(r=>{J(r),N(g),t.target.reset(),o(L,e);const a=Array.from(t.target.querySelectorAll(e.inputSelector));n(t.target,a,e)}).catch(e=>{console.error("Error creating card:",e)}).finally(()=>{a(L,!1)})}),i.getAppInfo().then(([e,t])=>{t.forEach(function(e){J(e,"append")}),u.textContent=e.name,m.textContent=e.about,c.src=e.avatar}).catch(e=>{console.error("Error fetching initial cards:",e)}),H=e,document.querySelectorAll(H.formSelector).forEach(e=>{((e,o)=>{const n=Array.from(e.querySelectorAll(o.inputSelector)),a=e.querySelector(o.submitButtonSelector);r(n,a,o),n.forEach(s=>{s.addEventListener("input",c=>{((e,r,o)=>{r.validity.valid?t(e,r,o):((e,t,r,o)=>{const n=e.querySelector(`#${t.id}-error`);t.classList.add(o.inputErrorClass),n.textContent=r,n.classList.add(o.errorClass)})(e,r,r.validationMessage,o)})(e,s,o),r(n,a,o)})})})(e,H)})}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dEI1SSxFQUFZcUYsaUJBQWlCbkYsRUFBT1IsZ0JBRWhDaUIsRUFBZ0JYLEVBQVlJLGNBQWNGLEVBQU9QLHNCQUV2RGMsRUFBa0JDLEVBQVdDLEVBQWVULEdBRTVDUSxFQUFVVSxRQUFTbkIsSUFDakJBLEVBQWFtRyxpQkFBaUIsUUFBVTZDLElBbkRqQkMsRUFBQ2xKLEVBQWFDLEVBQWNDLEtBQ2hERCxFQUFhWSxTQUFTQyxNQVF6QmYsRUFBZUMsRUFBYUMsRUFBY0MsR0F6QnZCaUosRUFBQ25KLEVBQWFDLEVBQWNtSixFQUFjbEosS0FDL0QsTUFBTUMsRUFBZUgsRUFBWUksY0FBYyxJQUFJSCxFQUFhSSxZQUVoRUosRUFBYUssVUFBVVksSUFBSWhCLEVBQU9MLGlCQUNsQ00sRUFBYUssWUFBYzRJLEVBQzNCakosRUFBYUcsVUFBVVksSUFBSWhCLEVBQU9KLGFBYWhDcUosQ0FDRW5KLEVBQ0FDLEVBQ0FBLEVBQWFvSixrQkFDYm5KLElBOENBZ0osQ0FBbUJsSixFQUFhQyxFQUFjQyxHQUM5Q08sRUFBa0JDLEVBQVdDLEVBQWVULFFBUTlDOEksQ0FBa0JELEVBQVE3SSxJIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9oZWxwZXJzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxufTtcblxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlLCBjb25maWcpID0+IHtcbiAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuXG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xuICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5lcnJvckNsYXNzKTtcbn07XG5cbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBjb25zdCBlcnJvckVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG5cbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG4gIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5lcnJvckNsYXNzKTtcbn07XG5cbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcbiAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICBzaG93SW5wdXRFcnJvcihcbiAgICAgIGZvcm1FbGVtZW50LFxuICAgICAgaW5wdXRFbGVtZW50LFxuICAgICAgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlLFxuICAgICAgY29uZmlnXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xuICB9XG59O1xuXG5jb25zdCBoYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0KSA9PiB7XG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XG4gIH0pO1xufTtcblxuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpID0+IHtcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QsIGNvbmZpZykpIHtcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG4gIH0gZWxzZSB7XG4gICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcblxuICAgIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgfVxufTtcblxuY29uc3QgZGlzYWJsZUJ1dHRvbiA9IChidXR0b25FbGVtZW50LCBjb25maWcpID0+IHtcbiAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XG59O1xuXG5jb25zdCByZXNldFZhbGlkYXRpb24gPSAoZm9ybUVsZW1lbnQsIGlucHV0TGlzdCwgY29uZmlnKSA9PiB7XG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dCwgY29uZmlnKTtcbiAgfSk7XG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcbn07XG5cbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbGVtZW50LCBjb25maWcpID0+IHtcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKVxuICApO1xuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcblxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGNoZWNrSW5wdXRWYWxpZGl0eShmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuICAgIH0pO1xuICB9KTtcbn07XG5cbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKTtcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsKSA9PiB7XG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsLCBjb25maWcpO1xuICB9KTtcbn07XG5cbmV4cG9ydCB7IGVuYWJsZVZhbGlkYXRpb24sIHJlc2V0VmFsaWRhdGlvbiwgZGlzYWJsZUJ1dHRvbiwgc2V0dGluZ3MgfTtcblxuIiwiZXhwb3J0IGZ1bmN0aW9uIHNldEJ1dHRvblRleHQoXG4gIGJ1dHRvbkVsZW1lbnQsXG4gIGlzTG9hZGluZyxcbiAgZGVmYXVsdFRleHQgPSBcIlNhdmVcIixcbiAgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiXG4pIHtcbiAgaWYgKGlzTG9hZGluZykge1xuICAgIGJ1dHRvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcbiAgfSBlbHNlIHtcbiAgICBidXR0b25FbGVtZW50LnRleHRDb250ZW50ID0gZGVmYXVsdFRleHQ7XG4gIH1cbn1cbiIsImltcG9ydCB7XG4gIGVuYWJsZVZhbGlkYXRpb24sXG4gIHJlc2V0VmFsaWRhdGlvbixcbiAgZGlzYWJsZUJ1dHRvbixcbiAgc2V0dGluZ3MsXG59IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjtcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgbG9nbyBmcm9tIFwiLi4vaW1hZ2VzL2xvZ28uc3ZnXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcbmltcG9ydCB7IHNldEJ1dHRvblRleHQgfSBmcm9tIFwiLi4vdXRpbHMvaGVscGVycy5qc1wiO1xuXG5jb25zdCBsb2dvSW1nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJsb2dvXCIpO1xuY29uc3QgcHJvZmlsZVBpYyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZS1waWN0dXJlXCIpO1xuXG5sb2dvSW1nLnNyYyA9IGxvZ287XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjg4ODJjMjJjLTIxNDgtNGUwNi05NTNlLTNiYWI4YmFhNDEyMFwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbmNvbnN0IGVkaXRQcm9maWxlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ0blwiKTtcbmNvbnN0IGVkaXRQcm9maWxlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtcHJvZmlsZS1tb2RhbFwiKTtcblxuY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25hbWVcIik7XG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xuY29uc3QgcHJvZmlsZUZvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IHByb2ZpbGVOYW1lSW5wdXQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1uYW1lXCIpO1xuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjZGVzY3JpcHRpb25cIik7XG5cbmNvbnN0IHByb2ZpbGVQaWNNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1waWN0dXJlLW1vZGFsXCIpO1xuY29uc3QgcHJvZmlsZVBpY0J0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ0blwiKTtcbmNvbnN0IHByb2ZpbGVQaWNGb3JtRWxlbWVudCA9IHByb2ZpbGVQaWNNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuY29uc3QgcHJvZmlsZVBpY0lucHV0ID0gcHJvZmlsZVBpY01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1waWN0dXJlLWlucHV0XCIpO1xuXG5jb25zdCBkZWxldGVDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1jYXJkLW1vZGFsXCIpO1xuY29uc3QgZGVsZXRlQ2FyZEZvcm1FbGVtZW50ID0gZGVsZXRlQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5cbmNvbnN0IG5ld1Bvc3RCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX25ldy1wb3N0LWJ0blwiKTtcbmNvbnN0IG5ld1Bvc3RNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LXBvc3QtbW9kYWxcIik7XG5cbmNvbnN0IG1vZGFsU3VibWl0QnV0dG9uID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcbmNvbnN0IG1vZGFsQ2xvc2VCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xuY29uc3QgbW9kYWxFbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxcIik7XG5cbmNvbnN0IGFkZENhcmRGb3JtRWxlbWVudCA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuY29uc3QgbmV3UG9zdENhcHRpb25JbnB1dCA9IG5ld1Bvc3RNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2NhcHRpb25cIik7XG5jb25zdCBuZXdQb3N0TGlua0lucHV0ID0gbmV3UG9zdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjaW1hZ2UtbGlua1wiKTtcbmNvbnN0IGNhcmRzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50XG4gIC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIilcbiAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpO1xuXG5jb25zdCBwcmV2aWV3TW9kYWxFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LW1vZGFsXCIpO1xuY29uc3QgcHJldmlld01vZGFsSW1hZ2UgPSBwcmV2aWV3TW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuY29uc3QgcHJldmlld01vZGFsQ2FwdGlvbiA9XG4gIHByZXZpZXdNb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcblxubGV0IHNlbGVjdGVkQ2FyZCwgc2VsZWN0ZWRDYXJkSWQ7XG5cbmZ1bmN0aW9uIG9wZW5Nb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfaXMtb3BlblwiKTtcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VPcGVuTW9kYWxzT25Fc2NhcGUpO1xufVxuXG5mdW5jdGlvbiBjbG9zZU1vZGFsKG1vZGFsKSB7XG4gIG1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9pcy1vcGVuXCIpO1xuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBjbG9zZU9wZW5Nb2RhbHNPbkVzY2FwZSk7XG59XG5cbmZ1bmN0aW9uIGNsb3NlT3Blbk1vZGFsc09uRXNjYXBlKGV2dCkge1xuICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgIG1vZGFsRWxlbWVudHMuZm9yRWFjaCgobW9kYWwpID0+IHtcbiAgICAgIGlmIChtb2RhbC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9pcy1vcGVuXCIpKSB7XG4gICAgICAgIGNsb3NlTW9kYWwobW9kYWwpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIHJlbmRlckNhcmQoY2FyZERhdGEsIG1ldGhvZCA9IFwicHJlcGVuZFwiKSB7XG4gIGNvbnN0IG5ld0NhcmQgPSBnZXRDYXJkRWxlbWVudChjYXJkRGF0YSk7XG4gIGNhcmRzQ29udGFpbmVyW21ldGhvZF0obmV3Q2FyZCk7XG59XG5cbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEpIHtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY2xvbmVOb2RlKHRydWUpO1xuICBjb25zdCBjYXJkVGl0bGVFbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVzY3JpcHRpb25cIik7XG4gIGNvbnN0IGNhcmRJbWFnZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgY29uc3QgbGlrZUJ0bkVsZW1lbnQgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ljb25cIik7XG4gIGNvbnN0IGNhcmREZWxldGVFbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ0blwiKTtcblxuICBpZiAoZGF0YS5pc0xpa2VkID09IHRydWUpIGxpa2VCdG5FbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJjYXJkX19pY29uX2FjdGl2ZVwiKTtcblxuICBjYXJkSW1hZ2VFbC5zcmMgPSBkYXRhLmxpbms7XG4gIGNhcmRJbWFnZUVsLmFsdCA9IGRhdGEubmFtZTtcbiAgY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG5cbiAgbGlrZUJ0bkVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+XG4gICAgaGFuZGxlTGlrZUJ0bkNsaWNrKGV2dCwgZGF0YS5faWQpXG4gICk7XG5cbiAgY2FyZERlbGV0ZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxuICAgIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEpXG4gICk7XG5cbiAgY2FyZEltYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBoYW5kbGVJbWFnZUNsaWNrKGRhdGEpO1xuICB9KTtcblxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUxpa2VCdG5DbGljayhldnQsIGlkKSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnN0IGxpa2VCdG5FbGVtZW50ID0gZXZ0LnRhcmdldDtcblxuICBhcGlcbiAgICAuZWRpdExpa2VTdGF0dXMoe1xuICAgICAgY2FyZElkOiBpZCxcbiAgICAgIGlzTGlrZWQ6ICFsaWtlQnRuRWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoXCJjYXJkX19pY29uX2FjdGl2ZVwiKSxcbiAgICB9KVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIGxpa2VCdG5FbGVtZW50LmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19pY29uX2FjdGl2ZVwiKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZWRpdGluZyBsaWtlIHN0YXR1czpcIiwgZXJyKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhkYXRhKSB7XG4gIHByZXZpZXdNb2RhbEltYWdlLnNyYyA9IGRhdGEubGluaztcbiAgcHJldmlld01vZGFsSW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xuICBwcmV2aWV3TW9kYWxDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuXG4gIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWxFbGVtZW50KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgZGF0YSkge1xuICBzZWxlY3RlZENhcmQgPSBjYXJkRWxlbWVudDtcbiAgc2VsZWN0ZWRDYXJkSWQgPSBkYXRhLl9pZDtcbiAgb3Blbk1vZGFsKGRlbGV0ZUNhcmRNb2RhbCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmRGb3JtU3VibWl0KGV2dCkge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3Qgc3VibWl0QnRuID0gZXZ0LnN1Ym1pdHRlcjtcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIHRydWUsIFwiRGVsZXRlXCIsIFwiRGVsZXRpbmcuLi5cIik7XG5cbiAgYXBpXG4gICAgLmRlbGV0ZUNhcmQoc2VsZWN0ZWRDYXJkSWQpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgc2VsZWN0ZWRDYXJkLnJlbW92ZSgpO1xuICAgICAgY2xvc2VNb2RhbChkZWxldGVDYXJkTW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBkZWxldGluZyBjYXJkOlwiLCBlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIGZhbHNlLCBcIkRlbGV0ZVwiLCBcIkRlbGV0aW5nLi4uXCIpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgY29uc3Qgc3VibWl0QnRuID0gZXZ0LnN1Ym1pdHRlcjtcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIHRydWUpO1xuXG4gIGFwaVxuICAgIC5lZGl0VXNlckluZm8oe1xuICAgICAgbmFtZTogcHJvZmlsZU5hbWVJbnB1dC52YWx1ZSxcbiAgICAgIGFib3V0OiBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSxcbiAgICB9KVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBwcm9maWxlTmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEuYWJvdXQ7XG4gICAgICBjbG9zZU1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB1cGRhdGluZyB1c2VyIGluZm86XCIsIGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgZmFsc2UpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlUGljRm9ybVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgY29uc3Qgc3VibWl0QnRuID0gZXZ0LnN1Ym1pdHRlcjtcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIHRydWUpO1xuXG4gIGFwaVxuICAgIC5lZGl0VXNlckF2YXRhcih7XG4gICAgICBhdmF0YXI6IHByb2ZpbGVQaWNJbnB1dC52YWx1ZSxcbiAgICB9KVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBwcm9maWxlUGljLnNyYyA9IGRhdGEuYXZhdGFyO1xuICAgICAgY2xvc2VNb2RhbChwcm9maWxlUGljTW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB1cGRhdGluZyB1c2VyIGluZm86XCIsIGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgZmFsc2UpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVOZXdQb3N0Rm9ybVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgY29uc3Qgc3VibWl0QnRuID0gZXZ0LnN1Ym1pdHRlcjtcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIHRydWUpO1xuXG4gIGNvbnN0IG5ld0NhcmREYXRhID0ge1xuICAgIG5hbWU6IG5ld1Bvc3RDYXB0aW9uSW5wdXQudmFsdWUsXG4gICAgbGluazogbmV3UG9zdExpbmtJbnB1dC52YWx1ZSxcbiAgfTtcblxuICBhcGlcbiAgICAuYWRkQ2FyZChuZXdDYXJkRGF0YSlcbiAgICAudGhlbigoY2FyZERhdGFXaXRoSWQpID0+IHtcbiAgICAgIHJlbmRlckNhcmQoY2FyZERhdGFXaXRoSWQpO1xuICAgICAgY2xvc2VNb2RhbChuZXdQb3N0TW9kYWwpO1xuXG4gICAgICBldnQudGFyZ2V0LnJlc2V0KCk7XG4gICAgICBkaXNhYmxlQnV0dG9uKG1vZGFsU3VibWl0QnV0dG9uLCBzZXR0aW5ncyk7XG4gICAgICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKFxuICAgICAgICBldnQudGFyZ2V0LnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuaW5wdXRTZWxlY3RvcilcbiAgICAgICk7XG4gICAgICByZXNldFZhbGlkYXRpb24oZXZ0LnRhcmdldCwgaW5wdXRMaXN0LCBzZXR0aW5ncyk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGNyZWF0aW5nIGNhcmQ6XCIsIGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRCdXR0b25UZXh0KG1vZGFsU3VibWl0QnV0dG9uLCBmYWxzZSk7XG4gICAgfSk7XG59XG5cbm1vZGFsQ2xvc2VCdXR0b25zLmZvckVhY2goKGJ1dHRvbikgPT4ge1xuICBjb25zdCByZWxhdGVkTW9kYWwgPSBidXR0b24uY2xvc2VzdChcIi5tb2RhbFwiKTtcbiAgYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBjbG9zZU1vZGFsKHJlbGF0ZWRNb2RhbCkpO1xufSk7XG5cbm1vZGFsRWxlbWVudHMuZm9yRWFjaCgobW9kYWwpID0+IHtcbiAgbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICBpZiAoZXZ0LnRhcmdldCA9PT0gbW9kYWwpIHtcbiAgICAgIGNsb3NlTW9kYWwobW9kYWwpO1xuICAgIH1cbiAgfSk7XG59KTtcblxuZWRpdFByb2ZpbGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgcHJvZmlsZU5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcbiAgcmVzZXRWYWxpZGF0aW9uKFxuICAgIGVkaXRQcm9maWxlTW9kYWwsXG4gICAgW3Byb2ZpbGVOYW1lSW5wdXQsIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0XSxcbiAgICBzZXR0aW5nc1xuICApO1xuICBvcGVuTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XG59KTtcblxucHJvZmlsZVBpY0J0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICBvcGVuTW9kYWwocHJvZmlsZVBpY01vZGFsKTtcbn0pO1xuXG5uZXdQb3N0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gIG9wZW5Nb2RhbChuZXdQb3N0TW9kYWwpO1xufSk7XG5cbnByb2ZpbGVQaWNGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZVByb2ZpbGVQaWNGb3JtU3VibWl0KTtcbnByb2ZpbGVGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KTtcbmRlbGV0ZUNhcmRGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZURlbGV0ZUNhcmRGb3JtU3VibWl0KTtcbmFkZENhcmRGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZU5ld1Bvc3RGb3JtU3VibWl0KTtcblxuYXBpXG4gIC5nZXRBcHBJbmZvKClcbiAgLnRoZW4oKFt1c2VySW5mbywgY2FyZHNdKSA9PiB7XG4gICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZERhdGEpIHtcbiAgICAgIHJlbmRlckNhcmQoY2FyZERhdGEsIFwiYXBwZW5kXCIpO1xuICAgIH0pO1xuXG4gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2VySW5mby5uYW1lO1xuICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXJJbmZvLmFib3V0O1xuICAgIHByb2ZpbGVQaWMuc3JjID0gdXNlckluZm8uYXZhdGFyO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBpbml0aWFsIGNhcmRzOlwiLCBlcnIpO1xuICB9KTtcblxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XG4iLCJjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xuICB9XG5cbiAgZ2V0QXBwSW5mbygpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0VXNlckluZm8oKSwgdGhpcy5nZXRJbml0aWFsQ2FyZHMoKV0pO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXNUZXh0fWApO1xuICAgIH0pO1xuICB9XG5cbiAgZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIC8vIFNlbmQgdGhlIGRhdGEgaW4gdGhlIGJvZHkgYXMgYSBKU09OIHN0cmluZy5cbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXNUZXh0fWApO1xuICAgIH0pO1xuICB9XG5cbiAgZWRpdFVzZXJBdmF0YXIoeyBhdmF0YXIgfSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcixcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c1RleHR9YCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBlZGl0TGlrZVN0YXR1cyh7IGNhcmRJZCwgaXNMaWtlZCB9KSB7XG4gICAgY29uc29sZS5sb2coaXNMaWtlZCk7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogaXNMaWtlZCA/IFwiUFVUXCIgOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXNUZXh0fWApO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChpZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzVGV4dH1gKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGFkZENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgbGluayxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c1RleHR9YCk7XG4gICAgfSk7XG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXNUZXh0fWApO1xuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEFwaTtcbiJdLCJuYW1lcyI6WyJzZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiaGlkZUlucHV0RXJyb3IiLCJmb3JtRWxlbWVudCIsImlucHV0RWxlbWVudCIsImNvbmZpZyIsImVycm9yRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsImNsYXNzTGlzdCIsInJlbW92ZSIsInRleHRDb250ZW50IiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbGVtZW50Iiwic29tZSIsInZhbGlkaXR5IiwidmFsaWQiLCJoYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJhZGQiLCJyZXNldFZhbGlkYXRpb24iLCJmb3JFYWNoIiwiaW5wdXQiLCJzZXRCdXR0b25UZXh0IiwiaXNMb2FkaW5nIiwiZGVmYXVsdFRleHQiLCJsb2FkaW5nVGV4dCIsImxvZ29JbWciLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwicHJvZmlsZVBpYyIsInNyYyIsImFwaSIsImNvbnN0cnVjdG9yIiwiYmFzZVVybCIsImhlYWRlcnMiLCJ0aGlzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldEFwcEluZm8iLCJQcm9taXNlIiwiYWxsIiwiZ2V0VXNlckluZm8iLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJyZWplY3QiLCJzdGF0dXNUZXh0IiwiZWRpdFVzZXJJbmZvIiwibmFtZSIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlZGl0VXNlckF2YXRhciIsImF2YXRhciIsImVkaXRMaWtlU3RhdHVzIiwiY2FyZElkIiwiaXNMaWtlZCIsImNvbnNvbGUiLCJsb2ciLCJkZWxldGVDYXJkIiwiYWRkQ2FyZCIsImxpbmsiLCJhdXRob3JpemF0aW9uIiwiZWRpdFByb2ZpbGVCdG4iLCJlZGl0UHJvZmlsZU1vZGFsIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwcm9maWxlRm9ybUVsZW1lbnQiLCJwcm9maWxlTmFtZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJwcm9maWxlUGljTW9kYWwiLCJwcm9maWxlUGljQnRuIiwicHJvZmlsZVBpY0Zvcm1FbGVtZW50IiwicHJvZmlsZVBpY0lucHV0IiwiZGVsZXRlQ2FyZE1vZGFsIiwiZGVsZXRlQ2FyZEZvcm1FbGVtZW50IiwibmV3UG9zdEJ0biIsIm5ld1Bvc3RNb2RhbCIsIm1vZGFsU3VibWl0QnV0dG9uIiwibW9kYWxDbG9zZUJ1dHRvbnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwibW9kYWxFbGVtZW50cyIsImFkZENhcmRGb3JtRWxlbWVudCIsIm5ld1Bvc3RDYXB0aW9uSW5wdXQiLCJuZXdQb3N0TGlua0lucHV0IiwiY2FyZHNDb250YWluZXIiLCJjYXJkVGVtcGxhdGUiLCJjb250ZW50IiwicHJldmlld01vZGFsRWxlbWVudCIsInByZXZpZXdNb2RhbEltYWdlIiwicHJldmlld01vZGFsQ2FwdGlvbiIsInNlbGVjdGVkQ2FyZCIsInNlbGVjdGVkQ2FyZElkIiwib3Blbk1vZGFsIiwibW9kYWwiLCJhZGRFdmVudExpc3RlbmVyIiwiY2xvc2VPcGVuTW9kYWxzT25Fc2NhcGUiLCJjbG9zZU1vZGFsIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImtleSIsImNvbnRhaW5zIiwicmVuZGVyQ2FyZCIsImNhcmREYXRhIiwibmV3Q2FyZCIsImRhdGEiLCJjYXJkRWxlbWVudCIsImNsb25lTm9kZSIsImNhcmRUaXRsZUVsIiwiY2FyZEltYWdlRWwiLCJsaWtlQnRuRWxlbWVudCIsImNhcmREZWxldGVFbCIsImFsdCIsInByZXZlbnREZWZhdWx0IiwidGFyZ2V0IiwidG9nZ2xlIiwiY2F0Y2giLCJlcnIiLCJlcnJvciIsImhhbmRsZUxpa2VCdG5DbGljayIsIl9pZCIsImhhbmRsZURlbGV0ZUNhcmQiLCJoYW5kbGVJbWFnZUNsaWNrIiwiZ2V0Q2FyZEVsZW1lbnQiLCJidXR0b24iLCJyZWxhdGVkTW9kYWwiLCJjbG9zZXN0IiwidmFsdWUiLCJzdWJtaXRCdG4iLCJzdWJtaXR0ZXIiLCJmaW5hbGx5IiwibmV3Q2FyZERhdGEiLCJjYXJkRGF0YVdpdGhJZCIsInJlc2V0IiwiQXJyYXkiLCJmcm9tIiwidXNlckluZm8iLCJjYXJkcyIsImZvcm1FbCIsInNldEV2ZW50TGlzdGVuZXJzIiwiZXZlbnQiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTWVzc2FnZSIsInZhbGlkYXRpb25NZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==